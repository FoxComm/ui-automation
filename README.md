#FoxCommerce UI Automation

The FoxCommerce E2E UI automation test framework. Used for automating UI test scenarios across Store Admin and Storefront.

##Installation

####Ubuntu
1. Install Java:

	```
	sudo apt-get install default-jdk
	```

2. Install SBT:

	```
	echo "deb https://dl.bintray.com/sbt/debian /" | sudo tee -a /etc/apt/sources.list.d/sbt.list
	sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 642AC823
	sudo apt-get update
	sudo apt-get install sbt
	```

3. Install Scala:

	```
	sudo apt-get install scala
	```

4. Install Chrome:

	Go download it!

5. Get Chromedriver:

	Get the latest version at https://sites.google.com/a/chromium.org/chromedriver/downloads

6. Run configuration script:

	```
	make configure-linux
	```

####MacOS
1. Install Java:

	```
	brew cask install java
	```

2. Install SBT:

	```
	brew install sbt
	```

3. Install Scala:

	```
	brew install scala
	```

4. Install Chrome:

	You already have it :)

5. Get Chromedriver:

	Get the latest version at https://sites.google.com/a/chromium.org/chromedriver/downloads

6. Run configuration script:

	```
	make configure
	```


##Running Tests

####Locally

1. Compile:

	```
	make build
	```

2. Run tests:

	```
	make test
	```

####Buildkite CI
* To configure the environment against which to run tests, change `$API_URL` value to what you need.
* Builds are scheduled on 7 p.m. PST
* Scheduled build is run against `stage`

##Reporting

* [Allure framework](https://github.com/allure-framework/allure1/wiki)
    Report is generated using allure-cli tool either manually (if run locally) or automatically in Buildkite.
    Each new test run overrides previous report.
* To generate report after running tests locally, do this under project directory:

	```
	allure generate target/allure-results
	allure report open
	```

* [Report](http://10.240.0.32:8080/) generated by Buildkite can be accessed under VPN.
* List of used features:
  * `@Step` -- marks a method in PageClass as a Step which is then used in TestClass out of Page object as a test step (e.g. `clickEditBtn()`).
  * `@Attachment` -- marks `takeScreenShot()` and `errorText()`
  * Environment -- displays system information about enviorment against which test run has been run. Information is gathered automatically by a build script and then passed to report.

##Stack

* Language: Java
* Framework: TestNG, Selenide, self-made wrappers
* Build Tool: SBT
* Reporting: Allure

##Project Structure


```

                                                               ┌                            ┐
                                                               │ page object                │
                                                               │ is created in testMethod() │
                          ┌                                    │ inside of a TestClass      │
                          │         ┌─────────────┐            └                            ┘
                          │         │  TestClass  │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┐
        ┌────────────┐    │         └─────────────┘                                      ¦
        │ testng.xml │◄───┤                   ▲                                          ¦
        └────────────┘    │           extends │      ┌─────────────┐                     ¦
         [test suits]     │                   │      │  TestClass  │                     ¦
                          │                   │      └─────────────┘                     ¦
                          └                   │         ▲       ▲                        ¦
                                              │ extends │       ¦                        ¦
                                              ├─────────┘       ¦                        ¦
                  ┌──────────────┐            │                 ¦                        ¦
                  │ bin/payloads ├────────┐   │                 ¦                        ¦
                  └──────────────┘        │   │                 ¦                        ¦
                                          ▼   │                 ¦                        ¦
                                        ┌─────┴────────┐      ┌─────────────┐    ┌─────────────┐
                                        │ DataProvider │      │  PageClass  │    │  PageClass  │
          [fulfills test preconditions] └──────────────┘      └─────────────┘    └─────────────┘
                                            ▲   ▲                        ▲         ▲
                                            ¦   │ extends        extends │         │ extends
        ┌─────────────┐                     ¦   │                        │         │
        │ Phoenix API │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┘   │                        │         │
        └─────────────┘                         │                        │         │
                                         ┌──────┴──────┐              ┌──┴─────────┴─┐
                                         │  BaseTest   │              │   BasePage   │
                                         └─────────────┘              └──────────────┘
                                                ▲                             ▲
                                        extends │                             │ extends
                                                │    ┌────────────────────────┘
                                                │    │
                                                │    │
                                         ┌──────┴────┴──┐ implements      ┌─────────────┐
      [wrappers, helpers, screenshoter]  │  ConciseAPI  ├────────────────►│  IHookable  │
                                         └──────────────┘                 └─────────────┘
                                                                         [TestNG listener]


```
